import{r as c,j as e,a as A,X as y,A as P}from"./index-B0-dYYhW.js";import{C as S}from"./check-L4g8Rsdc.js";import{S as E}from"./save-DaQs6UXF.js";import"./vendor-BtP0CW_r.js";const M=({token:d,role:g})=>{const[u,j]=c.useState([]),[h,f]=c.useState([]),[N,b]=c.useState(!0),[z,v]=c.useState(null),[_,p]=c.useState(!1),[s,o]=c.useState(null),m=P,w=a=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(Number(a)),x=async()=>{b(!0);try{const a={"Content-Type":"application/json",Authorization:`Bearer ${d}`},t=[fetch(`${m}/users/api/subscriptions/plans/`,{headers:a})];g==="super_admin"&&t.push(fetch(`${m}/users/api/subscriptions/tenants/`,{headers:a}));const[n,l]=await Promise.all(t);if(n&&n.ok){const i=await n.json();j(Array.isArray(i)?i:i.results||[])}if(l&&l.ok){const i=await l.json();f(Array.isArray(i)?i:i.results||[])}}catch{v("Error cargando datos")}finally{b(!1)}};c.useEffect(()=>{x()},[d]);const k=async(a,t)=>{if(confirm("¿Estás seguro de asignar este plan?")){p(!0);try{const n={"Content-Type":"application/json",Authorization:`Bearer ${d}`};(await fetch(`${m}/users/api/subscriptions/plans/${t}/assign/`,{method:"POST",headers:n,body:JSON.stringify({user_id:a})})).ok?await x():alert("Error asignando plan")}catch{alert("Error de conexión")}finally{p(!1)}}},C=async a=>{if(a.preventDefault(),!!s)try{const t={"Content-Type":"application/json",Authorization:`Bearer ${d}`};(await fetch(`${m}/users/api/subscriptions/plans/${s.id}/`,{method:"PATCH",headers:t,body:JSON.stringify(s)})).ok?(o(null),await x()):alert("Error actualizando el plan")}catch{alert("Error de conexión")}},r=(a,t)=>{o(n=>n?{...n,[a]:t}:null)};return N?e.jsx("div",{className:"p-8 text-center text-white",children:"Cargando planes..."}):e.jsxs("div",{className:"space-y-10 relative animate-fade-in",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:u.map((a,t)=>{const n=a.name.toLowerCase().includes("professional")||a.name.toLowerCase().includes("medio");return e.jsxs("div",{className:`
                relative flex flex-col p-8 rounded-2xl border transition-all duration-300 group
                ${n?"bg-gradient-to-b from-gray-800/80 to-gray-900/80 border-emerald-500/50 shadow-2xl shadow-emerald-900/20 transform md:-translate-y-4":"bg-gray-900/40 border-gray-800 hover:border-gray-700 hover:bg-gray-900/60"}
              `,children:[n&&e.jsx("div",{className:"absolute -top-4 left-1/2 -translate-x-1/2 bg-gradient-to-r from-emerald-500 to-teal-500 text-white text-xs font-bold px-4 py-1 rounded-full shadow-lg tracking-wide uppercase",children:"Más Popular"}),g==="super_admin"&&e.jsx("button",{onClick:()=>o(a),className:"absolute top-4 right-4 p-2 rounded-full text-gray-500 hover:text-white hover:bg-white/10 transition-all opacity-0 group-hover:opacity-100",title:"Editar Plan",children:e.jsx(A,{size:16})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:a.name}),e.jsx("p",{className:"text-gray-400 text-sm leading-relaxed min-h-[40px]",children:a.description})]}),e.jsxs("div",{className:"mb-8 flex items-baseline",children:[e.jsx("span",{className:"text-4xl font-bold text-white tracking-tight",children:w(a.price)}),e.jsx("span",{className:"text-gray-500 ml-2 text-sm font-medium",children:"/mes"})]}),e.jsxs("div",{className:"space-y-4 mb-8 flex-1",children:[e.jsxs("div",{className:"space-y-3 pb-6 border-b border-gray-800/50",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Usuarios"}),e.jsx("span",{className:"font-semibold text-white",children:a.max_users===-1?"Ilimitados":a.max_users})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Productos"}),e.jsx("span",{className:"font-semibold text-white",children:a.max_products===-1?"Ilimitados":a.max_products})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Categorías"}),e.jsx("span",{className:"font-semibold text-white",children:a.max_categories===-1?"Ilimitadas":a.max_categories})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Transacciones"}),e.jsxs("span",{className:"font-semibold text-white",children:[a.max_transactions_per_month===-1?"Ilimitadas":a.max_transactions_per_month,"/mes"]})]})]}),e.jsx("div",{className:"space-y-3 pt-2",children:[{key:"enable_user_management",label:"Gestión de Usuarios"},{key:"enable_web_store",label:"Tienda Virtual"},{key:"enable_inventory_management",label:"Inventario Avanzado"},{key:"enable_marketing_tools",label:"Herramientas de Marketing"},{key:"enable_advanced_sales_analysis",label:"Análisis Avanzado"},{key:"enable_supplier_management",label:"Gestión de Proveedores"},{key:"enable_daily_backups",label:"Copias de Seguridad"},{key:"enable_whatsapp_notifications",label:"Notif. WhatsApp"},{key:"enable_electronic_invoicing",label:"Facturación Electrónica"}].map(l=>e.jsxs("div",{className:"flex items-start gap-3 text-sm group/item",children:[e.jsx("div",{className:`mt-0.5 p-0.5 rounded-full ${a[l.key]?"text-emerald-400 bg-emerald-500/10":"text-gray-600 bg-gray-800"}`,children:a[l.key]?e.jsx(S,{size:12,strokeWidth:3}):e.jsx(y,{size:12,strokeWidth:3})}),e.jsx("span",{className:`${a[l.key]?"text-gray-300":"text-gray-600 line-through"}`,children:l.label})]},l.key))})]}),e.jsx("button",{className:`
                w-full py-3.5 rounded-xl font-semibold text-sm transition-all duration-200 shadow-lg
                ${n?"bg-gradient-to-r from-emerald-500 to-teal-500 hover:from-emerald-400 hover:to-teal-400 text-white shadow-emerald-900/20":"bg-gray-800 hover:bg-gray-700 text-white hover:text-white border border-gray-700"}
              `,children:"Seleccionar Plan"})]},a.id)})}),e.jsxs("div",{className:"pt-8 border-t border-gray-800",children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:[e.jsx("span",{className:"w-1 h-6 bg-emerald-500 rounded-full"}),"Asignación de Planes"]}),e.jsx("div",{className:"bg-gray-900/40 rounded-2xl overflow-hidden border border-gray-800 shadow-xl",children:e.jsxs("table",{className:"w-full text-left text-gray-300",children:[e.jsx("thead",{className:"bg-gray-900 text-gray-400",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4",children:"Administrador"}),e.jsx("th",{className:"p-4",children:"Email"}),e.jsx("th",{className:"p-4",children:"Estadísticas"}),e.jsx("th",{className:"p-4",children:"Plan Actual"}),e.jsx("th",{className:"p-4",children:"Acciones"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-700",children:[h.map(a=>e.jsxs("tr",{className:"hover:bg-gray-750",children:[e.jsx("td",{className:"p-4 font-medium text-white",children:a.username}),e.jsx("td",{className:"p-4",children:a.email}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex flex-col space-y-1 text-xs text-gray-400",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-white font-medium",children:a.clients_count||0})," Clientes"]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-white font-medium",children:a.sales_count||0})," Ventas"]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-white font-medium",children:a.products_count||0})," Productos"]})]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${a.plan_name?a.plan_name.includes("Básico")?"bg-blue-900 text-blue-300":a.plan_name.includes("Medio")?"bg-purple-900 text-purple-300":"bg-green-900 text-green-300":"bg-gray-700 text-gray-400"}`,children:a.plan_name||"Sin Plan"})}),e.jsx("td",{className:"p-4",children:e.jsxs("select",{className:"bg-gray-700 border-none rounded text-sm text-white focus:ring-2 focus:ring-blue-500",value:a.plan_id||"",onChange:t=>k(a.admin_id,t.target.value),disabled:_,children:[e.jsx("option",{value:"",children:"Seleccionar plan..."}),u.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})})]},a.id)),h.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"p-8 text-center text-gray-500",children:"No hay administradores registrados"})})]})]})})]}),s&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-xl border border-gray-700 shadow-2xl w-full max-w-lg overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-700 flex justify-between items-center bg-gray-900",children:[e.jsxs("h3",{className:"text-xl font-bold text-white",children:["Editar ",s.name]}),e.jsx("button",{onClick:()=>o(null),className:"text-gray-400 hover:text-white",children:e.jsx(y,{size:24})})]}),e.jsxs("form",{onSubmit:C,className:"p-6 space-y-4 max-h-[80vh] overflow-y-auto custom-scrollbar",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Nombre"}),e.jsx("input",{type:"text",value:s.name,onChange:a=>r("name",a.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white focus:ring-2 focus:ring-blue-500 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Precio ($)"}),e.jsx("input",{type:"number",step:"0.01",value:s.price,onChange:a=>r("price",a.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white focus:ring-2 focus:ring-blue-500 outline-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Descripción"}),e.jsx("textarea",{value:s.description,onChange:a=>r("description",a.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white focus:ring-2 focus:ring-blue-500 outline-none h-20 resize-none"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Máx. Usuarios (-1 ilim.)"}),e.jsx("input",{type:"number",value:s.max_users,onChange:a=>r("max_users",parseInt(a.target.value)),className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white focus:ring-2 focus:ring-blue-500 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Máx. Transacciones (-1 ilim.)"}),e.jsx("input",{type:"number",value:s.max_transactions_per_month,onChange:a=>r("max_transactions_per_month",parseInt(a.target.value)),className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white focus:ring-2 focus:ring-blue-500 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Máx. Productos (-1 ilim.)"}),e.jsx("input",{type:"number",value:s.max_products,onChange:a=>r("max_products",parseInt(a.target.value)),className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white focus:ring-2 focus:ring-blue-500 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Máx. Categorías (-1 ilim.)"}),e.jsx("input",{type:"number",value:s.max_categories,onChange:a=>r("max_categories",parseInt(a.target.value)),className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white focus:ring-2 focus:ring-blue-500 outline-none"})]})]}),e.jsxs("div",{className:"space-y-3 pt-4 border-t border-gray-700",children:[e.jsx("h4",{className:"font-medium text-white",children:"Funcionalidades"}),e.jsxs("label",{className:"flex items-center gap-3 p-2 rounded hover:bg-gray-700 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.enable_user_management,onChange:a=>r("enable_user_management",a.target.checked),className:"w-4 h-4 rounded border-gray-600 text-blue-600 focus:ring-blue-500 bg-gray-700"}),e.jsx("span",{className:"text-gray-300",children:"Habilitar Gestión de Usuarios"})]}),e.jsxs("label",{className:"flex items-center gap-3 p-2 rounded hover:bg-gray-700 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.enable_web_store,onChange:a=>r("enable_web_store",a.target.checked),className:"w-4 h-4 rounded border-gray-600 text-blue-600 focus:ring-blue-500 bg-gray-700"}),e.jsx("span",{className:"text-gray-300",children:"Habilitar Tienda Virtual"})]}),e.jsxs("label",{className:"flex items-center gap-3 p-2 rounded hover:bg-gray-700 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.enable_inventory_management,onChange:a=>r("enable_inventory_management",a.target.checked),className:"w-4 h-4 rounded border-gray-600 text-blue-600 focus:ring-blue-500 bg-gray-700"}),e.jsx("span",{className:"text-gray-300",children:"Habilitar Inventario Avanzado"})]}),e.jsxs("label",{className:"flex items-center gap-3 p-2 rounded hover:bg-gray-700 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.enable_marketing_tools,onChange:a=>r("enable_marketing_tools",a.target.checked),className:"w-4 h-4 rounded border-gray-600 text-blue-600 focus:ring-blue-500 bg-gray-700"}),e.jsx("span",{className:"text-gray-300",children:"Habilitar Herramientas de Marketing"})]}),e.jsxs("label",{className:"flex items-center gap-3 p-2 rounded hover:bg-gray-700 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.enable_advanced_sales_analysis,onChange:a=>r("enable_advanced_sales_analysis",a.target.checked),className:"w-4 h-4 rounded border-gray-600 text-blue-600 focus:ring-blue-500 bg-gray-700"}),e.jsx("span",{className:"text-gray-300",children:"Habilitar Análisis Avanzado"})]}),e.jsxs("label",{className:"flex items-center gap-3 p-2 rounded hover:bg-gray-700 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.enable_supplier_management,onChange:a=>r("enable_supplier_management",a.target.checked),className:"w-4 h-4 rounded border-gray-600 text-blue-600 focus:ring-blue-500 bg-gray-700"}),e.jsx("span",{className:"text-gray-300",children:"Habilitar Gestión de Proveedores"})]}),e.jsxs("label",{className:"flex items-center gap-3 p-2 rounded hover:bg-gray-700 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.enable_daily_backups,onChange:a=>r("enable_daily_backups",a.target.checked),className:"w-4 h-4 rounded border-gray-600 text-blue-600 focus:ring-blue-500 bg-gray-700"}),e.jsx("span",{className:"text-gray-300",children:"Habilitar Copias de Seguridad"})]}),e.jsxs("label",{className:"flex items-center gap-3 p-2 rounded hover:bg-gray-700 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.enable_whatsapp_notifications,onChange:a=>r("enable_whatsapp_notifications",a.target.checked),className:"w-4 h-4 rounded border-gray-600 text-blue-600 focus:ring-blue-500 bg-gray-700"}),e.jsx("span",{className:"text-gray-300",children:"Habilitar Notificaciones WhatsApp"})]}),e.jsxs("label",{className:"flex items-center gap-3 p-2 rounded hover:bg-gray-700 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.enable_electronic_invoicing,onChange:a=>r("enable_electronic_invoicing",a.target.checked),className:"w-4 h-4 rounded border-gray-600 text-blue-600 focus:ring-blue-500 bg-gray-700"}),e.jsx("span",{className:"text-gray-300",children:"Habilitar Facturación Electrónica"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 mt-2",children:[e.jsx("button",{type:"button",onClick:()=>o(null),className:"px-4 py-2 rounded bg-gray-700 hover:bg-gray-600 text-white font-medium",children:"Cancelar"}),e.jsxs("button",{type:"submit",className:"px-4 py-2 rounded bg-blue-600 hover:bg-blue-700 text-white font-medium flex items-center gap-2",children:[e.jsx(E,{size:18})," Guardar Cambios"]})]})]})]})})]})};export{M as default};
