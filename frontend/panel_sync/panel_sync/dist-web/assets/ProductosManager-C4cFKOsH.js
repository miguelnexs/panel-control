import{c as Q,r as a,j as e,T as E,C as T,S as Y,R as Z,P as B,a as ee,b as se,X as te}from"./index-B0-dYYhW.js";import{P as x}from"./package-B0XPr4Gt.js";import{E as re}from"./eye-BOztA-m_.js";import{T as ae}from"./tag-DlfPgKEu.js";import{D as le}from"./dollar-sign-_EJxGbDI.js";import{P as ie}from"./palette-Ce57apDO.js";import"./vendor-BtP0CW_r.js";/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],oe=Q("circle-x",ce),be=({token:c,apiBase:o,onCreate:N,onEdit:w})=>{const[n,L]=a.useState([]),[m,d]=a.useState(null),[_,S]=a.useState(!1),[r,p]=a.useState(null),[I,z]=a.useState([]),[k,C]=a.useState([]),[$,D]=a.useState(""),[g,O]=a.useState(""),[j,q]=a.useState("all"),[f,F]=a.useState(!1),[u,V]=a.useState(5),h=s=>({...s?{Authorization:`Bearer ${s}`}:{}}),v=async()=>{d(null),S(!0);try{const s=await fetch(`${o}/products/`,{headers:h(c)}),t=await s.json();if(!s.ok)throw new Error(t.detail||"No se pudieron cargar productos");L(t)}catch(s){d({type:"error",text:s.message})}finally{S(!1)}};a.useEffect(()=>{c&&v()},[c]),a.useEffect(()=>{c&&(async()=>{try{const l=await(await fetch(`${o}/products/categories/?page_size=100`,{headers:h(c)})).json(),i=Array.isArray(l.results)?l.results:[];z(i)}catch{}})()},[c]);const A=s=>{if(s===""||s==null)return"";const t=Number(s);return Number.isNaN(t)?"":t.toLocaleString("es-CO",{style:"currency",currency:"COP",maximumFractionDigits:0})},b=s=>{const t=Number(s.total_stock??s.inventory_qty??0);return Number.isFinite(t)?t:0},R=n.filter(s=>{const t=$.trim().toLowerCase(),l=t===""||String(s.name||"").toLowerCase().includes(t),i=!g||String(s.category)===String(g)||String(s.category_name||"")===String(g),H=j==="all"||(j==="active"?!!s.active:!s.active),G=b(s),J=!f||G<Number(u||0);return l&&i&&H&&J}),W=n.length,U=n.filter(s=>b(s)<Number(u||0)).length,K=n.filter(s=>!!s.active).length,M=n.filter(s=>!s.active).length,X=async s=>{if(confirm("¿Estás seguro de eliminar este producto?")){d(null);try{const t=await fetch(`${o}/products/${s}/`,{method:"DELETE",headers:h(c)});if(!t.ok){const l=await t.json();throw new Error(l.detail||"No se pudo eliminar")}d({type:"success",text:"Producto eliminado correctamente"}),v()}catch(t){d({type:"error",text:t.message})}}},P=s=>s?s.startsWith("http://")||s.startsWith("https://")?s:s.startsWith("/")?`${o}${s}`:s.startsWith("media/")?`${o}/${s}`:`${o}/media/${s}`:"",y=({label:s,value:t,icon:l,color:i})=>e.jsxs("div",{className:"bg-gray-900 border border-gray-800 rounded-xl p-4 flex items-center justify-between shadow-sm hover:border-gray-700 transition-all group",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-xs font-medium uppercase tracking-wider mb-1",children:s}),e.jsx("p",{className:"text-2xl font-bold text-white group-hover:scale-105 transition-transform origin-left",children:t})]}),e.jsx("div",{className:`p-3 rounded-lg bg-opacity-10 ${i.bg}`,children:e.jsx(l,{className:`w-6 h-6 ${i.text}`})})]});return e.jsxs("div",{className:"space-y-6 relative animate-in fade-in duration-500",children:[_&&e.jsx("div",{className:"absolute inset-0 z-50 bg-gray-950/50 backdrop-blur-sm flex items-center justify-center rounded-2xl",children:e.jsxs("div",{className:"bg-gray-900 border border-gray-800 rounded-2xl p-8 shadow-2xl flex flex-col items-center",children:[e.jsx("div",{className:"w-10 h-10 border-4 border-blue-500/30 border-t-blue-500 rounded-full animate-spin mb-4"}),e.jsx("div",{className:"text-white font-medium",children:"Cargando inventario..."})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(y,{label:"Total Productos",value:W,icon:x,color:{bg:"bg-blue-500",text:"text-blue-500"}}),e.jsx(y,{label:"Stock Bajo",value:U,icon:E,color:{bg:"bg-amber-500",text:"text-amber-500"}}),e.jsx(y,{label:"Activos",value:K,icon:T,color:{bg:"bg-emerald-500",text:"text-emerald-500"}}),e.jsx(y,{label:"Inactivos",value:M,icon:oe,color:{bg:"bg-rose-500",text:"text-rose-500"}})]}),m&&e.jsxs("div",{className:`p-4 rounded-xl text-sm flex items-center gap-3 border ${m.type==="success"?"bg-emerald-500/10 text-emerald-400 border-emerald-500/20":"bg-rose-500/10 text-rose-400 border-rose-500/20"}`,children:[m.type==="success"?e.jsx(T,{size:18}):e.jsx(E,{size:18}),m.text]}),e.jsxs("div",{className:"bg-gray-900 border border-gray-800 rounded-2xl overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"p-5 border-b border-gray-800 flex flex-col xl:flex-row xl:items-center justify-between gap-4 bg-gray-900/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-indigo-500/10 rounded-lg",children:e.jsx(x,{className:"w-5 h-5 text-indigo-500"})}),e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Inventario"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsxs("div",{className:"relative group",children:[e.jsx(Y,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500 group-focus-within:text-blue-500 transition-colors"}),e.jsx("input",{type:"text",value:$,onChange:s=>D(s.target.value),placeholder:"Buscar producto...",className:"pl-9 pr-4 py-2 bg-gray-800 border border-gray-700 rounded-xl text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 transition-all w-full md:w-64"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("select",{value:g,onChange:s=>O(s.target.value),className:"px-3 py-2 bg-gray-800 border border-gray-700 rounded-xl text-sm text-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500/50 cursor-pointer",children:[e.jsx("option",{value:"",children:"Todas las categorías"}),I.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsxs("select",{value:j,onChange:s=>q(s.target.value),className:"px-3 py-2 bg-gray-800 border border-gray-700 rounded-xl text-sm text-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500/50 cursor-pointer",children:[e.jsx("option",{value:"all",children:"Todos"}),e.jsx("option",{value:"active",children:"Activos"}),e.jsx("option",{value:"inactive",children:"Inactivos"})]}),e.jsxs("div",{className:"flex items-center px-3 py-2 bg-gray-800 border border-gray-700 rounded-xl",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:f,onChange:s=>F(s.target.checked),className:"rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{children:"Bajo stock"})]}),f&&e.jsx("input",{type:"number",min:0,value:u,onChange:s=>V(Number(s.target.value)||0),className:"ml-2 w-12 px-1 py-0.5 bg-gray-700 border border-gray-600 rounded text-center text-xs text-white"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 border-l border-gray-800 pl-2 ml-2",children:[e.jsx("button",{onClick:v,className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded-lg transition-colors",title:"Recargar",children:e.jsx(Z,{className:"w-4 h-4"})}),e.jsxs("button",{onClick:()=>{N&&N()},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-xl text-sm font-medium transition-all shadow-lg shadow-blue-900/20",children:[e.jsx(B,{className:"w-4 h-4"}),e.jsx("span",{children:"Nuevo"})]})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-800 bg-gray-800/30",children:[e.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-gray-400 uppercase tracking-wider",children:"Producto"}),e.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-gray-400 uppercase tracking-wider",children:"Precio"}),e.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-gray-400 uppercase tracking-wider",children:"Categoría"}),e.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-gray-400 uppercase tracking-wider",children:"Stock"}),e.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-gray-400 uppercase tracking-wider",children:"Estado"}),e.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-gray-400 uppercase tracking-wider text-right",children:"Acciones"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-800",children:[R.map(s=>e.jsxs("tr",{className:"hover:bg-gray-800/30 transition-colors group",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gray-800 border border-gray-700 overflow-hidden flex-shrink-0",children:s.image?e.jsx("img",{src:P(s.image),alt:s.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:e.jsx(x,{className:"w-5 h-5"})})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white group-hover:text-blue-400 transition-colors",children:s.name}),s.sku&&e.jsxs("div",{className:"text-xs text-gray-500",children:["SKU: ",s.sku]})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"font-medium text-gray-200",children:A(s.price)})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md bg-gray-800 text-xs text-gray-400 border border-gray-700",children:s.category_name||"Sin categoría"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:`font-medium ${b(s)<u?"text-amber-500":"text-emerald-500"}`,children:[b(s)," u."]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium border ${s.active?"bg-emerald-500/10 text-emerald-400 border-emerald-500/20":"bg-gray-700 text-gray-400 border-gray-600"}`,children:s.active?"Activo":"Inactivo"})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:async()=>{p(s);try{const l=await(await fetch(`${o}/products/${s.id}/colors/`,{headers:h(c)})).json(),i=Array.isArray(l.results)?l.results:l;C(Array.isArray(i)?i:[])}catch{C([])}},className:"p-2 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-white transition-colors",title:"Ver detalles",children:e.jsx(re,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{w&&w(s)},className:"p-2 rounded-lg hover:bg-blue-500/10 text-gray-400 hover:text-blue-400 transition-colors",title:"Editar",children:e.jsx(ee,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>X(s.id),className:"p-2 rounded-lg hover:bg-rose-500/10 text-gray-400 hover:text-rose-400 transition-colors",title:"Eliminar",children:e.jsx(se,{className:"w-4 h-4"})})]})})]},s.id)),n.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(x,{className:"w-12 h-12 mb-3 opacity-20"}),e.jsx("p",{children:"No se encontraron productos"})]})})})]})]})})]}),r&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-gray-900 border border-gray-800 rounded-2xl w-full max-w-3xl shadow-2xl scale-100 animate-in zoom-in-95 duration-200 flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-6 border-b border-gray-800 flex items-center justify-between shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg",children:e.jsx(ae,{className:"w-5 h-5 text-blue-500"})}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Detalle del Producto"})]}),e.jsx("button",{onClick:()=>p(null),className:"text-gray-500 hover:text-white transition-colors",children:e.jsx(te,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-6 overflow-y-auto",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"aspect-square w-full rounded-2xl bg-gray-800 border border-gray-700 overflow-hidden relative",children:[r.image?e.jsx("img",{src:P(r.image),alt:r.name,className:"w-full h-full object-cover"}):e.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center text-gray-600",children:[e.jsx(x,{className:"w-12 h-12 mb-2 opacity-50"}),e.jsx("span",{className:"text-sm",children:"Sin imagen"})]}),e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-bold shadow-lg ${r.active?"bg-emerald-500 text-white":"bg-gray-600 text-gray-200"}`,children:r.active?"ACTIVO":"INACTIVO"})})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-4 border border-gray-700",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Stock Total"}),e.jsxs("div",{className:"text-2xl font-bold text-white",children:[r.inventory_qty," u."]})]})]}),e.jsxs("div",{className:"md:col-span-2 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:r.name}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx("span",{className:"px-2.5 py-1 rounded-md bg-blue-500/10 text-blue-400 border border-blue-500/20",children:r.category_name||"Sin categoría"}),r.sku&&e.jsxs("span",{className:"text-gray-500",children:["SKU: ",r.sku]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{className:"w-5 h-5 text-emerald-500"}),e.jsx("span",{className:"text-3xl font-bold text-emerald-400",children:A(r.price)})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-300 mb-2",children:"Descripción"}),e.jsx("p",{className:"text-gray-400 text-sm leading-relaxed whitespace-pre-wrap bg-gray-800/30 p-4 rounded-xl border border-gray-800",children:r.description||"No hay descripción disponible para este producto."})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(ie,{className:"w-4 h-4 text-purple-400"}),e.jsx("h4",{className:"text-sm font-medium text-gray-300",children:"Variantes de Color"})]}),k.length>0?e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:k.map(s=>e.jsxs("div",{className:"flex items-center gap-3 bg-gray-800 border border-gray-700 rounded-lg p-3 hover:border-gray-600 transition-colors",children:[e.jsx("div",{className:"w-8 h-8 rounded-full border border-gray-600 shadow-sm",style:{backgroundColor:s.hex}}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-white",children:s.name}),e.jsxs("div",{className:"text-xs text-gray-400",children:["Stock: ",s.stock]})]})]},s.id))}):e.jsx("div",{className:"text-sm text-gray-500 italic bg-gray-800/30 p-3 rounded-lg border border-gray-800 border-dashed text-center",children:"Este producto no tiene variantes de color registradas."})]}),e.jsxs("div",{className:"pt-4 text-xs text-gray-600 border-t border-gray-800",children:["Registrado el: ",new Date(r.created_at).toLocaleDateString()]})]})]})}),e.jsx("div",{className:"p-4 border-t border-gray-800 bg-gray-900/50 rounded-b-2xl flex justify-end",children:e.jsx("button",{onClick:()=>p(null),className:"px-6 py-2.5 rounded-xl bg-gray-800 hover:bg-gray-700 text-white font-medium transition-colors",children:"Cerrar"})})]})})]})};export{be as default};
